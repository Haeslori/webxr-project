<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>WebVR 自由落体实验</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  <!-- 我们的脚本 -->
  <script src="app.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    #controls {
      position: fixed; top: 20px; left: 20px; z-index: 999;
      background: rgba(255,255,255,0.85); padding: 10px; border-radius: 5px;
    }
    #timerDisplay { margin-top: 8px; font-weight: bold; }
    button { margin: 0 4px; padding: 4px 8px; }
  </style>
</head>
<body>
  <!-- 桌面模式控制面板 -->
  <div id="controls">
    <input type="number" id="heightInput" value="4" min="1" max="8" step="0.5" />
    <button id="setHeightBtn">设定高度</button>
    <button id="startBtn">Start</button>
    <button id="resetBtn">Reset</button>
    <div id="timerDisplay">Dauer: 0.00 s</div>
  </div>

  <!-- A-Frame 场景 -->
  <a-scene
    freefall-controls
    webxr="optionalFeatures: local-floor"
    raycaster="objects: .clickable"
  >
    <!-- 地面 -->
    <a-plane rotation="-90 0 0" width="10" height="10" color="#555"></a-plane>

    <!-- 支架 & 滑轮 -->
    <a-box position="-1 3 -2" depth="0.2" height="6" width="0.2" color="#888"></a-box>
    <a-box position=" 1 3 -2" depth="0.2" height="6" width="0.2" color="#888"></a-box>
    <a-cylinder position="0 6 -2" radius="0.1" height="0.5" rotation="0 0 90" color="#aaa"></a-cylinder>

    <!-- 平台 & 球 -->
    <a-box   id="platform" position="0 4 -2" width="2" height="0.1" depth="2" color="#44f"></a-box>
    <a-sphere id="ball"     position="0 3.9 -2" radius="0.1" color="#f00"></a-sphere>

    <!-- VR 面板 -->
    <a-entity position="0 1.6 -1">
      <a-plane width="1.5" height="1.2" color="#222" opacity="0.8"></a-plane>

      <a-text id="vrTimer"       value="Dauer: 0.00 s" position="-0.7 0.4 0.01"
              scale="0.3 0.3 0.3" color="#0f0"></a-text>
      <a-text id="heightDisplay" value="Höhe: 4.0 m"    position="-0.7 0.0 0.01"
              scale="0.3 0.3 0.3" color="#fff"></a-text>

      <!-- Start -->
      <a-box class="clickable" button-listener="action:start"
             position="-0.6 -0.4 0" width="0.5" height="0.2" depth="0.02" color="#4CAF50">
        <a-text value="Start" align="center" position="0 0 0.03"
                scale="0.4 0.4 0.4" color="#000"></a-text>
      </a-box>

      <!-- Reset -->
      <a-box class="clickable" button-listener="action:reset"
             position="0.0 -0.4 0" width="0.5" height="0.2" depth="0.02" color="#f44336">
        <a-text value="Reset" align="center" position="0 0 0.03"
                scale="0.4 0.4 0.4" color="#000"></a-text>
      </a-box>

      <!-- Height + -->
      <a-box class="clickable" button-listener="action:height-up"
             position="0.6 -0.4 0" width="0.3" height="0.2" depth="0.02" color="#2196F3">
        <a-text value="+" align="center" position="0 0 0.03"
                scale="0.4 0.4 0.4" color="#000"></a-text>
      </a-box>

      <!-- Height - -->
      <a-box class="clickable" button-listener="action:height-down"
             position="1.0 -0.4 0" width="0.3" height="0.2" depth="0.02" color="#2196F3">
        <a-text value="–" align="center" position="0 0 0.03"
                scale="0.4 0.4 0.4" color="#000"></a-text>
      </a-box>
    </a-entity>

    <!-- 激光控制器 & 光标 -->
    <a-entity laser-controls="hand: left"  raycaster="objects:.clickable" cursor="rayOrigin:entity"></a-entity>
    <a-entity laser-controls="hand: right" raycaster="objects:.clickable" cursor="rayOrigin:entity"></a-entity>

    <!-- 摄像机 & 鼠标光标 -->
    <a-entity camera position="0 1.6 2">
      <a-cursor fuse="false"></a-cursor>
    </a-entity>

    <!-- 光源 -->
    <a-sky color="#ECECEC"></a-sky>
    <a-light type="ambient" color="#BBB"></a-light>
    <a-light type="directional" color="#FFF" intensity="0.6" position="-0.5 1 1"></a-light>
  </a-scene>
</body>
</html>
